{"version":3,"sources":["fuji.js"],"names":["nowTheme","document","body","getAttribute","window","matchMedia","matches","updateMeidumTheme","mediumInst","targetTheme","getNowTheme","detach","mediumZoom","background","updateUtterancesTheme","utterancesFrame","contentWindow","postMessage","type","theme","querySelector","addEventListener","loadComment","scrollTop","systemTheme","domTheme","setItem","localStorage","setAttribute","commentArea","reset","DISQUS","reload"],"mappings":"aAII,SAAIA,cAAJ,IAAIA,EAAWC,SAASC,KAAKC,aAAa,cAC1C,MAAiB,SAAbH,EACOI,OAAOC,WAAW,gCAAgCC,QAAU,OAAS,QAExD,SAAbN,EAAsB,OAAS,QAK9C,SAASO,kBAAkBC,GACvB,IAAIC,EAAcC,cACdF,IAAAA,EAAYG,SAGRH,EAFJ,SAAAA,EAEiBI,WAAW,gBAAiB,CADzCH,WAAgB,YAChBG,WAAA,gBAAA,CAGGC,WAAA,aASf,SAASC,sBAAsBC,GAC3B,IAAIN,EAAcC,cADtBK,IACsBL,SAAdD,EAGIM,EAAgBC,cAAcC,YAFlCF,CACeG,KAAK,YAChBH,MAAgBC,eAGD,uBAKfD,EAAgBC,cAAcC,YAEhB,CACCC,KAAA,YAEXC,MAAA,gBAGX,wBAiBGN,IAAAA,WAbJZ,SAASmB,cAAc,gCACvBnB,SAASmB,cAAc,+BAA+BC,iBAAiB,QAASC,aAIpFrB,SAASmB,cAAc,wBAAwBC,iBAAiB,QAAS,WAKrEb,SAAAA,gBAAYe,UAAA,IAChBf,WACI,SAAAE,cAGGE,WAAA,gBAAA,CACHJ,WAAaI,YAKjBA,WAAA,gBAAA,CAJQC,WAAY,YAQhBZ,SAAIuB,cAAcpB,yBAAkBiB,iBAAA,QAAgCf,WAFpE,IAAIN,EAAWU,cAIXe,EAAaxB,SAAQC,KAAAC,aAAA,cACrBqB,EAAApB,OAAAC,WAAA,gCAAAC,QAAA,OAAA,QAEaoB,SAAbC,GAEA1B,SAAAC,KAAA0B,aAAA,aAAA,UAAA5B,EAAA,OAAA,SACAC,aAAc2B,QAAAA,kBACd,UADyC5B,EACzC,OAAA,UAHoB,UAAbyB,GAAJxB,SAKAC,KAAA0B,aAAA,aAAA,QAEH3B,aAAc2B,QAAAA,kBACd,QADyCJ,EACzC,OAAA,UAIJvB,SAAAC,KAAA0B,aAAA,aAAA,SAHID,aAAaD,QAAQ,kBAAmC,SAAhBF,EAA0B,OAAS,UAO/EjB,kBAAkBN,YAEd,IAAA4B,EAAA5B,SAAAmB,cAAA,iBACInB,GAEIa,SAAAA,cAAsBb,+BAAuBE,aAA7C,WACH,eAAA0B,EAAA1B,aAAA,iBADGW,sBAAsBb,SAASmB,cAAc,yBAGhC,WAANU,EAAM3B,aAAA,iBACH4B,OAAED,MAAA,CADZE,QAAA","file":"fuji.min.js","sourcesContent":["'use strict';\n\n// get current theme\nfunction getNowTheme() {\n    let nowTheme = document.body.getAttribute('data-theme');\n    if (nowTheme === 'auto') {\n        return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';\n    } else {\n        return nowTheme === 'dark' ? 'dark' : 'light';\n    }\n}\n\n// update medium-zoom theme\nfunction updateMeidumTheme(mediumInst) {\n    let targetTheme = getNowTheme();\n    if (mediumInst) {\n        mediumInst.detach();\n        if (targetTheme === 'dark') {\n            mediumInst = mediumZoom('.img-zoomable', {\n                background: '#2f3136',\n            });\n        } else {\n            mediumInst = mediumZoom('.img-zoomable', {\n                background: '#fffffd',\n            });\n        }\n    }\n}\n\n// update utterances theme\nfunction updateUtterancesTheme(utterancesFrame) {\n    let targetTheme = getNowTheme();\n    if (utterancesFrame) {\n        if (targetTheme === 'dark') {\n            utterancesFrame.contentWindow.postMessage(\n                {\n                    type: 'set-theme',\n                    theme: 'photon-dark',\n                },\n                'https://utteranc.es'\n            );\n        } else {\n            utterancesFrame.contentWindow.postMessage(\n                {\n                    type: 'set-theme',\n                    theme: 'github-light',\n                },\n                'https://utteranc.es'\n            );\n        }\n    }\n}\n\n// load comment button only when comment area exist\nif (document.querySelector('span.post-comment-notloaded')) {\n    document.querySelector('span.post-comment-notloaded').addEventListener('click', loadComment);\n}\n\n// to-top button\ndocument.querySelector('.btn .btn-scroll-top').addEventListener('click', () => {\n    document.documentElement.scrollTop = 0;\n});\n\n// init medium-zoom\nvar mediumInst; // medium-zoom instance\nif (getNowTheme() === 'dark') {\n    mediumInst = mediumZoom('.img-zoomable', {\n        background: '#2f3136',\n    });\n} else {\n    mediumInst = mediumZoom('.img-zoomable', {\n        background: '#fffffd',\n    });\n}\n\n// theme switch button\ndocument.querySelector('.btn .btn-toggle-mode').addEventListener('click', () => {\n    let nowTheme = getNowTheme();\n    let domTheme = document.body.getAttribute('data-theme');\n    let systemTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';\n\n    if (domTheme === 'auto') {\n        // if now in auto mode, switch to user mode\n        document.body.setAttribute('data-theme', nowTheme === 'light' ? 'dark' : 'light');\n        localStorage.setItem('fuji_data-theme', nowTheme === 'light' ? 'dark' : 'light');\n    } else if (domTheme === 'light') {\n        // if now in user mode and light mode\n        document.body.setAttribute('data-theme', 'dark');\n        // if the theme want to switch is system theme\n        localStorage.setItem('fuji_data-theme', systemTheme === 'dark' ? 'auto' : 'dark');\n    } else {\n        // if now in user mode and dark mode\n        document.body.setAttribute('data-theme', 'light');\n        // if the theme want to switch is system theme\n        localStorage.setItem('fuji_data-theme', systemTheme === 'light' ? 'auto' : 'light');\n    }\n\n    // update medium background\n    updateMeidumTheme(mediumInst);\n    // switch comment area theme\n    // if this page has comment area\n    let commentArea = document.querySelector('.post-comment');\n    if (commentArea) {\n        // if comment area loaded\n        if (document.querySelector('span.post-comment-notloaded').getAttribute('style')) {\n            if (commentArea.getAttribute('data-comment') === 'utterances') {\n                updateUtterancesTheme(document.querySelector('.post-comment iframe'));\n            }\n            if (commentArea.getAttribute('data-comment') === 'disqus') {\n                DISQUS.reset({\n                    reload: true,\n                });\n            }\n        }\n    }\n});\n"]}