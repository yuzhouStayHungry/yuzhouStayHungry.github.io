<!DOCTYPE html>
<html lang="zh-hans">

<head>
    
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<meta name="HandheldFriendly" content="True" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<meta name="generator" content="Hugo 0.72.0" />


<link rel="apple-touch-icon" sizes="180x180" href="/images/img/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/images/img/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/images/img/favicon-16x16.png">
<link rel="manifest" href="/images/img/site.webmanifest">
<link rel="mask-icon" href="/images/img/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">



<title>Django API 开发：Django REST框架快速入门 - 宇宙之一粟的小屋</title>


<meta name="author" content="yuzhou1su" />


<meta name="description"
      content="A minimal Hugo theme with nice theme color." />


<meta name="keywords" content="Django, API开发" />


<meta property="og:title" content="Django API 开发：Django REST框架快速入门" />
<meta property="og:description" content="Django REST 框架 就像其他任何第三方应用程序一样，添加了Django REST Framework。 如果本地服务器Control &#43; c仍在运行，请确保退出它。 然后在命令行上键入以下内容。 (library) $ pipenv install djangorestframework==3.10.3 在我们的settings." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://yuzhoustayhungry.github.io/2020/09/django-api-%E5%BC%80%E5%8F%91django-rest%E6%A1%86%E6%9E%B6%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/" />
<meta property="og:image" content="https://yuzhoustayhungry.github.io/img/og.png"/>
<meta property="article:published_time" content="2020-09-16T11:33:31+08:00" />
<meta property="article:modified_time" content="2020-09-16T11:33:31+08:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://yuzhoustayhungry.github.io/img/og.png"/>

<meta name="twitter:title" content="Django API 开发：Django REST框架快速入门"/>
<meta name="twitter:description" content="Django REST 框架 就像其他任何第三方应用程序一样，添加了Django REST Framework。 如果本地服务器Control &#43; c仍在运行，请确保退出它。 然后在命令行上键入以下内容。 (library) $ pipenv install djangorestframework==3.10.3 在我们的settings."/>





<link rel="stylesheet" href="/assets/css/fuji.min.css" />







</head>

<body data-theme="auto">
    <script data-cfasync="false">
    
    var fujiThemeData = localStorage.getItem('fuji_data-theme');
    
    if (!fujiThemeData) {
        localStorage.setItem('fuji_data-theme', 'auto');
    } else {
        
        if (fujiThemeData !== 'auto') {
            document.body.setAttribute('data-theme', fujiThemeData === 'dark' ? 'dark' : 'light');
        }
    }
</script>
<script data-cfasync="false">
    
    var ua = window.navigator.userAgent;

    function browserDetection() {
        if (ua.indexOf('MSIE ') > 0 || ua.indexOf('Trident/') > 0 || ua.indexOf('Edge/') > 0) {
            return true;
        }
        return false;
    }

    if (browserDetection()) {
        window.location.href('https:\/\/yuzhoustayhungry.github.io\/ie\/');
    }
</script>
    <header>
    <div class="container-lg clearfix">
        <div class="col-12 header">
            <a class="title-main" href="https://yuzhoustayhungry.github.io/">宇宙之一粟的小屋</a>
            
            <span class="title-sub">Keep coding, Keep Loving. 热爱文学和技术，用有趣的知识武装头脑，分享简单的快乐</span>
            
        </div>
    </div>
</header>

    <main>
        <div class="container-lg clearfix">
            
            <div class="col-12 col-md-9 float-left content">
                
<article>
    
    <h2 class="post-item post-title">
        <a href="https://yuzhoustayhungry.github.io/2020/09/django-api-%E5%BC%80%E5%8F%91django-rest%E6%A1%86%E6%9E%B6%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/">Django API 开发：Django REST框架快速入门</a>
    </h2>
    <div class="post-item post-meta">
        <span><ion-icon name="today"></ion-icon></ion-icon>&nbsp;2020-09-16</span><span><ion-icon name="file-tray"></ion-icon>&nbsp;2192 字</span><span><ion-icon name="stopwatch"></ion-icon>&nbsp;5 分钟</span><span><ion-icon name="pricetags"></ion-icon>&nbsp;<a href="/tags/django">Django</a>&nbsp;<a href="/tags/api%E5%BC%80%E5%8F%91">API开发</a>&nbsp;</span>
    </div>
    
    
    <div class="post-content markdown-body">
        <h2 id="django-rest-框架">Django REST 框架</h2>
<p>就像其他任何第三方应用程序一样，添加了Django REST Framework。 如果本地服务器Control + c仍在运行，请确保退出它。 然后在命令行上键入以下内容。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#f92672">(</span>library<span style="color:#f92672">)</span> $ pipenv install djangorestframework<span style="color:#f92672">==</span>3.10.3
</code></pre></div><p>在我们的settings.py文件中，将rest_framework添加到INSTALLED_APPS配置中。 我喜欢在第三方应用程序和本地应用程序之间做出如下区分，因为在大多数项目中，应用程序的数量迅速增长。</p>
<p>最终，我们的API将公开一个端点，该端点列出JSON中的所有书籍。 因此，我们将需要一个新的URL路由，一个新的视图以及一个新的序列化器文件（稍后将对此进行更多介绍）。</p>
<p>我们可以用多种方法来组织这些文件，但是我的首选方法是创建一个专用的api应用程序。 这样，即使将来我们增加更多应用程序，每个应用程序都可以包含专用网页所需的模型，视图，模板和url，但是整个项目的所有API专用文件都将驻留在专用api应用程序中。</p>
<p>让我们新建一个<code>api</code>应用程序。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#f92672">(</span>library<span style="color:#f92672">)</span> $ python manage.py startapp api
</code></pre></div><p>然后增加到 INSTALLED_APPS</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># library_project/settings.py</span>
INSTALLED_APPS <span style="color:#f92672">=</span> [
    <span style="color:#e6db74">&#39;django.contrib.admin&#39;</span>,
    <span style="color:#e6db74">&#39;django.contrib.auth&#39;</span>,
    <span style="color:#e6db74">&#39;django.contrib.contenttypes&#39;</span>,
    <span style="color:#e6db74">&#39;django.contrib.sessions&#39;</span>,
    <span style="color:#e6db74">&#39;django.contrib.messages&#39;</span>,
    <span style="color:#e6db74">&#39;django.contrib.staticfiles&#39;</span>,

    <span style="color:#75715e"># 3rd party</span>
    <span style="color:#e6db74">&#39;rest_framework&#39;</span>,

    <span style="color:#75715e"># Local Apps</span>
    <span style="color:#e6db74">&#39;books.apps.BooksConfig&#39;</span>,
    <span style="color:#e6db74">&#39;api.apps.ApiConfig&#39;</span>, <span style="color:#75715e"># new</span>
]
</code></pre></div><p>api应用程序将没有自己的数据库模型，因此无需像通常那样创建迁移文件和更新数据库。</p>
<h2 id="urls">URLs</h2>
<p>让我们从我们的URL配置开始。 添加API端点就像配置传统Django应用的路由一样。 首先，在项目级别，我们需要包括api应用程序并配置其URL路由，即api /。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> django.contrib <span style="color:#f92672">import</span> admin
<span style="color:#f92672">from</span> django.urls <span style="color:#f92672">import</span> path, include

urlpatterns <span style="color:#f92672">=</span> [
    path(<span style="color:#e6db74">&#39;admin/&#39;</span>, admin<span style="color:#f92672">.</span>site<span style="color:#f92672">.</span>urls),
    path(<span style="color:#e6db74">&#39;&#39;</span>, include(<span style="color:#e6db74">&#39;books.urls&#39;</span>)),
    path(<span style="color:#e6db74">&#39;api/&#39;</span>, include(<span style="color:#e6db74">&#39;api.urls&#39;</span>)), <span style="color:#75715e"># new</span>
]
</code></pre></div><p>然后在api应用程序中创建<code>urls.py</code>文件。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#f92672">(</span>library<span style="color:#f92672">)</span> $ touch api/urls.py
</code></pre></div><p>然后更新这个文件，如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># api/urls.py</span>
<span style="color:#f92672">from</span> django.urls <span style="color:#f92672">import</span> path


<span style="color:#f92672">from</span> .views <span style="color:#f92672">import</span> BookAPIView


urlpatterns <span style="color:#f92672">=</span> [
    path(<span style="color:#e6db74">&#39;&#39;</span>, BookAPIView<span style="color:#f92672">.</span>as_view()),
]
</code></pre></div><p>一切准备就绪。</p>
<h2 id="views">Views</h2>
<p>接下来是我们的views.py文件，该文件依赖Django REST Framework的内置通用类视图。 这些是故意模仿传统Django基于类的通用视图的格式，但它们不是一回事。</p>
<p>为避免混淆，某些开发人员将调用API视图文件apiviews.py或api.py。 就个人而言，在专用的api应用程序中工作时，我发现仅调用Django REST框架视图文件views.py并不会造成混淆，但是在这一点上意见不一。</p>
<p>在我们的views.py文件中，将其更新为如下所示：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># api/views.py</span>

<span style="color:#f92672">from</span> rest_framework <span style="color:#f92672">import</span> generics

<span style="color:#f92672">from</span> books.models <span style="color:#f92672">import</span> Book
<span style="color:#f92672">from</span> .serializers <span style="color:#f92672">import</span> BookSerializer


<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">BookAPIView</span>(generics<span style="color:#f92672">.</span>ListAPIView):
    queryset <span style="color:#f92672">=</span> Book<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>all()
    serializer_class <span style="color:#f92672">=</span> BookSerializer
</code></pre></div><p>在最上面的几行中，我们导入Django REST Framework的通用类视图，我们的Books应用中的模型以及api应用中的序列化器（我们将在下一个序列化器中导入）。</p>
<p>然后，我们创建一个BookAPIView，它使用ListAPIView为所有书籍实例创建一个只读端点。 有许多通用的视图，我们将在后面的章节中进一步探讨它们。</p>
<p>在我们的视图中，仅需执行两个步骤，即指定所有可用书籍的queryset，然后指定将成为BookSerializer的serializer_class。</p>
<h2 id="serializers">Serializers</h2>
<p>序列化器将数据转换为易于在Internet上使用的格式（通常为JSON），并显示在API端点上。 在接下来的章节中，我们还将更深入地介绍序列化器和JSON。 现在，我想演示使用Django REST Framework创建序列化器以将Django模型转换为JSON是多么容易。</p>
<p>在api应用中创建一个<code>serializers.py</code>文件:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#f92672">(</span>library<span style="color:#f92672">)</span> $ touch api/serializers.py
</code></pre></div><p>然后在文本编辑器中更新为如下所示：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># api/serializers.py</span>
<span style="color:#f92672">from</span> rest_framework <span style="color:#f92672">import</span> serializers

<span style="color:#f92672">from</span> books.models <span style="color:#f92672">import</span> Book


<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">BookSerializer</span>(serializers<span style="color:#f92672">.</span>ModelSerializer):
    <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Meta</span>:
        model <span style="color:#f92672">=</span> Book
        fields <span style="color:#f92672">=</span> (<span style="color:#e6db74">&#39;title&#39;</span>, <span style="color:#e6db74">&#39;subtitle&#39;</span>, <span style="color:#e6db74">&#39;author&#39;</span>, <span style="color:#e6db74">&#39;isbn&#39;</span>)
</code></pre></div><p>首先，我们从Books应用程序中导入Django REST Framework的序列化器类和Book模型。 我们将Django REST Framework的ModelSerializer扩展到BookSerializer类中，该类指定我们的数据库模型Book和我们希望公开的数据库字段：标题，副标题，作者和isbn。</p>
<p>大概就是这样！ 完成了</p>
<h2 id="curl">cURL</h2>
<p>我们想看看我们的API端点是什么样子。 我们知道它应该在URL http://127.0.0.1:8000/api/返回JSON。 确保我们的本地Django服务器正在运行：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#f92672">(</span>library<span style="color:#f92672">)</span> $ python manage.py runserver
</code></pre></div><p>现在打开一个新的第二个命令行控制台。 我们将使用它来访问在现有命令行控制台中运行的API。</p>
<p>我们可以使用流行的cURL程序通过命令行执行HTTP请求。 我们需要一个基本的GET请求，以指定<code>curl</code>和我们要调用的URL。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">
$ curl http://127.0.0.1:8000/api/ 
<span style="color:#f92672">[</span>
  <span style="color:#f92672">{</span>
    <span style="color:#e6db74">&#34;title&#34;</span>:<span style="color:#e6db74">&#34;Django for Beginners&#34;</span>,
    <span style="color:#e6db74">&#34;subtitle&#34;</span>:<span style="color:#e6db74">&#34;Build websites with Python and Django&#34;</span>,       
    <span style="color:#e6db74">&#34;author&#34;</span>:<span style="color:#e6db74">&#34;William S. Vincent&#34;</span>, 
    <span style="color:#e6db74">&#34;isbn&#34;</span>:<span style="color:#e6db74">&#34;978-198317266&#34;</span>
  <span style="color:#f92672">}</span> 
<span style="color:#f92672">]</span>
</code></pre></div><p>数据全部以JSON格式存在，但格式不正确且难以理解。 幸运的是，Django REST Framework给我们带来了另一个惊喜：API端点的强大可视模式。</p>
<h2 id="browsable-api">Browsable API</h2>
<p>在本地服务器仍在第一个命令行控制台中运行的情况下，在Web浏览器中的http://127.0.0.1:8000/api/上导航到我们的API端点。</p>
<p><img class="img-zoomable" src="https://i.loli.net/2020/09/16/aDn5iGkTeEVqlvK.png" alt="image-20200916112842031" /></p>
<p>哇，看看！ Django REST Framework默认情况下提供此可视化。 此页面中内置了许多功能，我们将在整本书中进行探讨。 现在，我希望您将此页面与原始JSON端点进行比较。 单击“获取”按钮，然后从下拉菜单中选择“ json”。</p>
<p><img class="img-zoomable" src="https://i.loli.net/2020/09/16/2XZjx6TCq3t8OVm.png" alt="image-20200916112949042" /></p>
<p>这就是来自API端点的原始JSON的样子。 我认为我们可以同意Django REST Framework版本更具吸引力。</p>
<h2 id="总结">总结</h2>
<p>在本章中，我们讨论了很多内容，因此请不要担心现在是否会感到困惑。 首先，我们创建了一个传统的Django图书馆网站。 然后，我们添加了Django REST Framework，并能够以最少的代码添加API端点。</p>
<p>在接下来的两章中，我们将构建自己的Todo API后端，并将其与React驱动的前端连接，以演示一个完整的工作示例，这将有助于巩固所有这些理论在实践中的融合！</p>

    </div>
</article>


<div class="license markdown-body">
    <blockquote>
        <p>除特殊注明部分，本站内容采用 <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"
               target="_blank">CC BY-NC-SA 4.0</a> 进行许可。</p>
    </blockquote>
</div>


  <div id="vcomments"></div>
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src='//unpkg.com/valine/dist/Valine.min.js'></script>

  <script type="text/javascript">
    new Valine({
        el: '#vcomments' ,
        appId: 'jQ6E95rSWyJnP3Vm6RD44X7T-gzGzoHsz',
        appKey: 'ixeh3gWeKpul4xa6HKh5WErn',
        notify: 'false', 
        verify: 'false', 
        avatar:'mm', 
        placeholder: '谢谢你来了，说点什么吧...',
        visitor: 'true'
    });
  </script>



            </div>
            <aside class="col-12 col-md-3 float-left sidebar">
    
    
    <div class="sidebar-item sidebar-toc">
        <h3>目录</h3>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#django-rest-框架">Django REST 框架</a></li>
    <li><a href="#urls">URLs</a></li>
    <li><a href="#views">Views</a></li>
    <li><a href="#serializers">Serializers</a></li>
    <li><a href="#curl">cURL</a></li>
    <li><a href="#browsable-api">Browsable API</a></li>
    <li><a href="#总结">总结</a></li>
  </ul>
</nav>
    </div>
    
    
    <div class="sidebar-item sidebar-pages">
        <h3>文章</h3>
        <ul>
            
            <li>
                <a href="/">首页文章</a>
            </li>
            
            <li>
                <a href="/archives/">文章归档</a>
            </li>
            
            <li>
                <a href="/about/">关于作者</a>
            </li>
            
            <li>
                <a href="/index.xml" target="_blank">RSS</a>
            </li>
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-tags">
        <h3>标签云</h3>
        <div>
            
            <span>
                <a href="/tags/api%E5%BC%80%E5%8F%91/">API开发</a>
            </span>
            
            <span>
                <a href="/tags/django/">Django</a>
            </span>
            
            <span>
                <a href="/tags/go/">Go</a>
            </span>
            
            <span>
                <a href="/tags/python/">Python</a>
            </span>
            
            <span>
                <a href="/tags/%E5%89%91%E6%8C%87offer/">剑指offer</a>
            </span>
            
            <span>
                <a href="/tags/%E6%80%9D%E8%80%83/">思考</a>
            </span>
            
            <span>
                <a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a>
            </span>
            
            <span>
                <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/">数据结构与算法</a>
            </span>
            
            <span>
                <a href="/tags/%E7%AE%97%E6%B3%95/">算法</a>
            </span>
            
            <span>
                <a href="/tags/%E7%BC%96%E7%A8%8B%E6%80%9D%E6%83%B3/">编程思想</a>
            </span>
            
        </div>
    </div>
    
    <div class="sidebar-item sidebar-links">
        <h3>友情链接</h3>
        <ul>
            
            <li>
                <a href="https://github.com/yuzhouStayHungry" target="_blank"><span>GitHub</span></a>
            </li>
            
            <li>
                <a href="https://blog.csdn.net/yuzhou_1shu" target="_blank"><span>CSDN</span></a>
            </li>
            
            <li>
                <a href="https://www.jianshu.com/u/93e9b14c6fbd" target="_blank"><span>简书</span></a>
            </li>
            
        </ul>
    </div>
    
</aside>
        </div>
        <div class="btn">
    <div class="btn-toggle-mode">
        <ion-icon name="contrast"></ion-icon>
    </div>
    <div class="btn-scroll-top">
        <ion-icon name="chevron-up"></ion-icon>
    </div>
</div>
    </main>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_SVG"></script>

<footer>
    <div class="container-lg clearfix">
        <div class="col-12 footer">
            <span>&copy; 2020 <a href="https://yuzhoustayhungry.github.io/">宇宙之一粟</a> |
                基于 <a href="https://github.com/amzrk2/hugo-theme-fuji/"
                   target="_blank">Fuji-v2</a> & <a href="https://gohugo.io/"
                   target="_blank">Hugo</a> 构建</span>
        </div>
    </div>
</footer>
    
    <script src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.5/dist/medium-zoom.min.js"></script>
<script type="module" src="https://cdn.jsdelivr.net/npm/ionicons@5.0.1/dist/ionicons/ionicons.esm.js"></script>
<script nomodule="" src="https://cdn.jsdelivr.net/npm/ionicons@5.0.1/dist/ionicons/ionicons.js"></script>

<script src="/assets/js/fuji.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/components/prism-core.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/plugins/autoloader/prism-autoloader.min.js"></script>


</body>

</html>